<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>OBL Training – Module</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <nav>
    <a href="training.html">← Back to Training</a>
    <span class="user-level-badge">Level: <span id="userLevel"></span></span>
  </nav>

  <main>
    <h1 id="moduleTitle">Loading module...</h1>
    <div id="moduleContent"></div>

    <!-- Edit only visible for level 5 -->
    <div id="adminTools" style="display: none; margin-top: 1em;">
      <button onclick="editModule()">✏️ Edit Module</button>
    </div>
  </main>

  <footer>
    <button id="prevModule">← Previous</button>
    <button id="nextModule">Next →</button>
  </footer>

  <script>
    // Load user level
    const level = parseInt(localStorage.getItem("userLevel") || "1", 10);
    document.getElementById("userLevel").textContent = level;

    // Parse module from query string
    const params = new URLSearchParams(window.location.search);
    const moduleId = params.get("module");

    fetch("data/training_modules.json")
      .then(res => res.json())
      .then(data => {
        const mod = data.find(m => m.id === moduleId);
        if (!mod) return document.getElementById("moduleTitle").textContent = "Module not found";

        document.title = `OBL Training – ${mod.title}`;
        document.getElementById("moduleTitle").textContent = mod.title;
        document.getElementById("moduleContent").innerHTML = mod.content;

        if (level === 5) {
          document.getElementById("adminTools").style.display = "block";
        }
      });

    // Admin edit action
    function editModule() {
      alert("Edit modal coming next! (Write access only for level 5)");
    }
  </script>
</body>
</html>